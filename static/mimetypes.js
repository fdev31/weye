
mimes={audio:{display:function(item){ui.set_context('item');$('<audio src="/d'+item.path+'" controls><span>Audio preview not supported on your browser</span></audio>').appendTo($('#contents').html(ich.view_file({item:item,backlink:ui.doc_ref!='/',permalink:ui.permalink})));$('.filesize').each(function(i,x){var o=$(x);o.text(hr_size(eval(o.text())))});}},default:{display:function(item){ui.set_context('item');$('#contents').html(ich.view_file({item:item,backlink:ui.doc_ref!='/',permalink:ui.permalink}))
$('.filesize').each(function(i,x){var o=$(x);o.text(hr_size(eval(o.text())))});}},folder:{display:function(item){ui.set_context('folder');$.get('/c'+item.path).success(function(c){base_data=c;var is_an_app=false;var app_indice='infos.js';base_data.forEach(function(o){if(o.f===app_indice)
is_an_app=true;})
ui.plugin=null;if(is_an_app){$.ajax({url:'/d'+item.path+'/infos.js',dataType:'json'}).done(function(d){ui.plugin=d;if(!!item.templates){for(var key in item.templates){ich.addTemplate(key,item.templates[key]);};}
load_plugin();}).fail(function(e){$.pnotify({type:'error',title:"Invalid data",text:"Impossible to load application informations"});console.log("ERR",e);});}else{item.have_child=c.length>0;item.backlink=ui.doc_ref!='/';item.permalink=ui.permalink;c.forEach(function(e){if(!!!e.t)e.t=e.f;if(!!!e.e)e.e='name';if(!!!e.s)e.s=e.f;});item.child=c;finalize_item_list($('#contents').html(ich.view_list(item)));}});}},image:{display:function(item){ui.set_context('item');$('<img src="/d'+item.path+'" />').appendTo($('#contents').html(ich.view_file({item:item,backlink:ui.doc_ref!='/',permalink:ui.permalink})));$('.filesize').each(function(i,x){var o=$(x);o.text(hr_size(eval(o.text())))});}},text:{display:function(item){console.log('display###########################');ui.set_context('item');$('<div class="row-fluid"><small>Fullscreen: <i>Alt+F</i>, Toggle preview: <i>Alt+P</i></small></div><div class="row-fluid" id="epiceditor"></div> <div class="pull-right btn-group"></div>').appendTo($('#contents').html(ich.view_file({item:item,backlink:ui.doc_ref!='/',permalink:ui.permalink})));$('<button class="btn btn-success btn-large" onclick="editor_save()">Save changes</button>').appendTo($('#download_link').parent());var ajax_call=new $.ajax({url:'/d'+item.path,dataType:'text'});editor=new EpicEditor(epic_opts).load(function(){ajax_call.done(function(d){editor.importFile(item.path,d);}).fail(function(e){$.pnotify({type:'error',text:''+e});})});$('.filesize').each(function(i,x){var o=$(x);o.text(hr_size(eval(o.text())))});}},video:{display:function(item){ui.set_context('item');$('<video controls src="/d'+item.path+'">Alt descr</video>').appendTo($('#contents').html(ich.view_file({item:item,backlink:ui.doc_ref!='/',permalink:ui.permalink})));$('.filesize').each(function(i,x){var o=$(x);o.text(hr_size(eval(o.text())))});}}}