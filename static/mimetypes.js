
mimes={audio:{display:function(item){ui.set_context('item');$('<audio src="/d'+item.path+'" controls><span>Audio preview not supported on your browser</span></audio>').appendTo($('#contents').html(get_view('file',item)));}},default:{display:function(item){ui.set_context('item');$('#contents').html(get_view('file',item));}},folder:{display:function(item){ui.set_context('folder');$.get('/c'+item.path).success(function(c){console.log(c);base_data=uncompress_itemlist(c.children);var is_an_app=false;var app_indice='infos.js';base_data.forEach(function(o){if(o.name===app_indice)
is_an_app=true;})
ui.plugin=null;if(is_an_app){$.ajax({url:'/d'+item.path+'/infos.js',dataType:'json'}).done(function(d){ui.plugin=d;if(!!item.templates){for(var key in item.templates){ich.addTemplate(key,item.templates[key]);};}
load_plugin();}).fail(function(e){$.pnotify({type:'error',title:"Invalid data",text:"Impossible to load application informations"});console.log("ERR",e);});}else{item.have_child=base_data.length>0;item.backlink=ui.doc_ref!='/';item.permalink=ui.permalink;base_data.forEach(function(e){if(!!!e.title)e.title=e.name;if(!!!e.editables)e.editables='name';if(!!!e.searchable)e.searchable=e.title;});item.child=base_data;finalize_item_list($('#contents').html(get_view('list',item)));}});}},image:{display:function(item){ui.set_context('item');$('<img src="/d'+item.path+'" />').appendTo($('#contents').html(get_view('file',item)));}},text:{display:function(item){console.log('display###########################');$('<div class="row-fluid"><small>Fullscreen: <i>Alt+F</i>, Toggle preview: <i>Alt+P</i></small></div><div class="row-fluid" id="epiceditor"></div> <div class="pull-right btn-group"></div>').appendTo($('#contents').html(get_view('file',item)));$('<button class="btn btn-success btn-large" onclick="editor_save()">Save changes</button>').appendTo($('#download_link').parent());var ajax_call=new $.ajax({url:'/d'+item.path,dataType:'text'});editor=new EpicEditor(epic_opts).load(function(){ajax_call.done(function(d){editor.importFile(item.path,d);ui.set_context('item');}).fail(function(e){$.pnotify({type:'error',text:''+e});})});}},video:{display:function(item){ui.set_context('item');$('<video controls src="/d'+item.path+'">Alt descr</video>').appendTo($('#contents').html(get_view('file',item)));}}}